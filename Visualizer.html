<!doctype html>
<html>
<head>
  <title>Web Audio API</title>
  <!--Load scripts-->
  <script src="glMatrix_util.js" type="text/javascript"></script>
  <script src="Visualizer.js" type="text/javascript"></script>

  <!--Fragment Shader-->
  <script id="shader-fs" type="x-shader/x-fragment">
    precision mediump float;
    varying vec2 vTextureCoord;
    varying vec3 vVertexPosition;
    uniform sampler2D uSampler;

    void main() {
        float sCoord = floor(vTextureCoord.s * 16.0) / 16.0;
				float tCoord = floor(vTextureCoord.t * 16.0) / 16.0;
        gl_FragColor = texture2D(uSampler, vec2(sCoord, tCoord));
    }
  </script>

  <!--Vertex Shader-->
  <script id="shader-vs" type="x-shader/x-vertex">
    attribute vec3 aVertexPosition;
    attribute vec2 aTextureCoord;

    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    uniform sampler2D uSampler;
    uniform float uArrayAverageVertex;

    varying vec2 vTextureCoord;
    varying vec3 vVertexPosition;

    void main(void) {
      vec4 textureColor = texture2D(uSampler, vec2(aTextureCoord.s, aTextureCoord.t));
      vVertexPosition = aVertexPosition;
      vVertexPosition.y = (textureColor.r + textureColor.g + textureColor.b)/3.0;
      //vVertexPosition.x = uArrayAverageVertex;
      gl_Position = uPMatrix * uMVMatrix * vec4(vVertexPosition, 1.0);
      vTextureCoord = aTextureCoord;
    }
  </script>
</head>
<body onload="main()">
  <h1>Music Visualizer</h1>
  <canvas id="glCanvas" width="512" height="512"> OOPS </canvas>
  <p>Move slide to the right to zoom in.</p>
  <input type="range" id="slider" value="-5" min="-5" max="-1" step=".1">
  <p></p>
  <input type="range" id="slider2" value="0.2" min="0.01" max="1.0" step="0.01">
	<td><b>Enter file name to open:</b>
	<td> <input type="text" id="fileName" value="BoxCat_Games_-_05_-_Battle_Boss.mp3" />
</body>
</html>
